(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{307:function(t,e,a){"use strict";a(40),a(41);e.a={txt_deal_with:function(t){return t.replace(/(((https?:(?:\/\/)?)(?:[-;:&=\+\$,\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[\w]*))?)/gi,function(t){return'<a href="'+t+'" target="_blank">'+t+"</a>"})},getWeek:function(t){return t?new Date(t).getDay():""},date:function(t,e){if(!t)return"";var a=new Date(t),s=a.getFullYear(),n=a.getMonth()+1,o=a.getDate(),r=a.getHours(),l=a.getMinutes(),i=a.getSeconds(),u=function(t){return/^\d$/.test(t)?"0"+t:t};return e&&1!=e?2==e?u(n)+"/"+u(o)+" "+u(r)+":"+u(l):3==e?s+"-"+u(n)+"-"+u(o):4==e?u(r)+":"+u(l)+":"+u(i):5==e?u(s)+"/"+u(n)+"/"+u(o):void 0:s+"-"+u(n)+"-"+u(o)+" "+u(r)+":"+u(l)+":"+u(i)},bugStatusName:function(t){var e,a=[{code:"all",name:"全部"},{code:"New",name:"新建未分配"},{code:"Open",name:"待解决"},{code:"Reopen",name:"重新打开"},{code:"Hang-up",name:"挂起延期"},{code:"Fixed",name:"已解决"},{code:"Closed",name:"已关闭"}];for(e in a)if(a[e].code==t)return a[e].name},getOperatorsName:function(t){var e,a=[{value:"=",name:"="},{value:"!=",name:"!="},{value:">=",name:">="},{value:"<=",name:"<="},{value:">",name:">"},{value:"<",name:"<"},{value:"and",name:"and"},{value:"or",name:"or"},{value:"range",name:"范围"}];for(e in a)if(a[e].value==t)return a[e].name},getSearchTypeName:function(t){var e,a=[{value:"ID",name:"缺陷ID"},{value:"title",name:"缺陷标题"},{value:"priority",name:"优先级"},{value:"severity",name:"严重程度"},{value:"bug_type",name:"缺陷类型"},{value:"creator_user",name:"创建者"},{value:"closed_user",name:"关闭者"},{value:"fixed_user",name:"解决者"},{value:"assignedTo_user",name:"指派谁"},{value:"create_time",name:"创建日期"},{value:"closed_time",name:"关闭日期"},{value:"fixed_time",name:"解决日期"}];for(e in a)if(a[e].value==t)return a[e].name},QuickQperationName:function(t){var e,a=[{value:"no",name:"无"},{value:"WaitPending",name:"待我处理"},{value:"AssignedByMe",name:"指派给我"},{value:"ResolvedByMe",name:"我解决的"},{value:"ClosedByMe",name:"我关闭的"},{value:"CreatedByMe",name:"我创建的"},{value:"notClosed",name:"未关闭的"},{value:"NotResolved",name:"未解决的"},{value:"HighPriority",name:"高优先级"}];for(e in a)if(a[e].value==t)return a[e].name},flowdesc:function(t){var e,a=[{status:-1,name:"不涉及此项"},{status:0,name:"未开始"},{status:1,name:"设计中"},{status:2,name:"开发中"},{status:3,name:"开发完成"},{status:4,name:"待调试"},{status:5,name:"调试中"},{status:6,name:"调试"},{status:7,name:"进入测试"},{status:8,name:"测试中"},{status:9,name:"存在Bug"},{status:10,name:"修复Bug中"},{status:11,name:"回归Bug"},{status:12,name:"测试通过"},{status:13,name:"已上线"}];for(e in a)if(a[e].status==t)return a[e].name}}},437:function(t,e,a){var s=a(820);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);(0,a(20).default)("437b0565",s,!1,{sourceMap:!1})},819:function(t,e,a){"use strict";var s=a(437);a.n(s).a},820:function(t,e,a){(t.exports=a(19)(!1)).push([t.i,"",""])},947:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container mt-3"},[a("div",{staticClass:"row mt-5"},[a("div",{staticClass:"col-auto mr-auto"}),t._v(" "),a("div",{staticClass:"col-auto"},[t.userRules?a("nuxt-link",{attrs:{to:"/app/user-management/user/adduser"}},[a("button",{staticClass:"btn btn-create",attrs:{type:"btn"}},[t._v("+ 增加用户")])]):t._e()],1)]),t._v(" "),a("div",{staticClass:"row mt-3 mb-5 table_data"},[a("div",{staticClass:"col-xl-12 col-lg-12 col-md-12"},[a("el-table",{attrs:{data:t.tableData,"default-sort":{prop:"date",order:"descending"}}},[a("el-table-column",{attrs:{prop:"realname",label:"真实姓名",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"email",label:"E-mail"}}),t._v(" "),a("el-table-column",{attrs:{prop:"group_name",label:"群组",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"position",label:"岗位",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{label:"状态",sortable:"",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.user_status?a("span",[t._v("正常")]):t._e(),t._v(" "),2===e.row.user_status?a("span",{staticClass:"text-deadly"},[t._v("封禁")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"建立时间",width:"150","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("date")(e.row.create_time)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"更新时间",width:"150","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("date")(e.row.update_time)))])]}}])}),t._v(" "),t.userRules?a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return["admin"!==e.row.group&1===e.row.user_status?a("span",{on:{click:function(a){t.banned(e.row,a)}}},[a("button",{staticClass:"btn btn-outline-danger btn-sm",attrs:{type:"button",value:"2"}},[t._v("封禁")])]):t._e(),t._v(" "),"admin"!==e.row.group&2===e.row.user_status?a("span",{on:{click:function(a){t.banned(e.row,a)}}},[a("button",{staticClass:"btn btn-outline-success btn-sm",attrs:{type:"button",value:"1"}},[t._v("解封")])]):t._e(),t._v(" "),"admin"!==e.row.group?a("span",{on:{click:function(a){t.getUserId(e.row,a)}}},[a("button",{staticClass:"ml-1 btn btn-outline-dark btn-sm",attrs:{type:"button","data-toggle":"modal","data-target":"#reset-password"}},[t._v("密码")])]):t._e()]}}])}):t._e()],1)],1)]),t._v(" "),a("div",{staticClass:"modal fade",attrs:{id:"reset-password",tabindex:"-1",role:"dialog","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog modal-dialog-centered",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"form-group row col-md-auto"},[a("label",{staticClass:"mx-5",attrs:{for:"password"}},[t._v("密码")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.password.passwd,expression:"password.passwd"}],staticClass:"form-control input-lg mx-5 my-1",attrs:{type:"password",id:"password",placeholder:"请输入密码",minlength:"8",maxlength:"16",required:""},domProps:{value:t.password.passwd},on:{input:function(e){e.target.composing||t.$set(t.password,"passwd",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"form-group row col-md-auto"},[a("label",{staticClass:"mx-5",attrs:{for:"t-password"}},[t._v("确认密码")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.password.RepeatPasswd,expression:"password.RepeatPasswd"}],staticClass:"form-control input-lg mx-5 my-1",attrs:{type:"password",id:"t-password",placeholder:"请再次输入密码",minlength:"8",maxlength:"16",required:""},domProps:{value:t.password.RepeatPasswd},on:{input:function(e){e.target.composing||t.$set(t.password,"RepeatPasswd",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-cancel",attrs:{type:"button","data-dismiss":"modal"}},[t._v("关闭")]),t._v(" "),a("button",{staticClass:"btn btn-primary",attrs:{type:"submit"},on:{click:function(e){t.ResetPassword()}}},[t._v("提交")])])])])])])};s._withStripped=!0;var n=a(4),o=a.n(n),r=a(307),l=a(105),i={head:function(){return{title:"HDesk - 用户管理"}},layout:"head",filters:{date:r.a.date},data:function(){return{tableData:[],msg:"",bannedData:{user_id:"",code:""},password:{user_id:"",passwd:"",RepeatPasswd:""}}},computed:{userRules:function(){return l.a.UserMangeRules(this.$store.state.userInfo)}},created:function(){this.getAllUser()},methods:{getAllUser:function(){var t=this;o.a.get("/api/user/user_list").then(function(e){2e4===e.data.status&&(t.tableData=e.data.data)})},getUserId:function(t){this.password.user_id=t.user_id},ResetPassword:function(t){if(""!==this.password.passwd)if(this.password.passwd===this.password.RepeatPasswd)if(this.password.passwd.length<8|this.password.passwd.length>16)this.$notify.error({title:"提交失败",message:"密码的有效长度为8-16位"});else{var e=this;o()({method:"post",url:"/api/user/reset_passwd",data:JSON.stringify(e.password)}).then(function(t){2e4===t.data.status?($("#reset-password").modal("hide"),e.$notify.success({title:"成功",message:t.data.msg}),e.getAllUser()):e.$notify.error({title:"失败",message:t.data.msg})})}else this.$notify.error({title:"提交失败",message:"两次密码输入的不一致"});else this.$notify.error({title:"提交失败",message:"密码不能为空"})},banned:function(t,e){var a=this;a.bannedData.user_id=t.user_id,a.bannedData.code=e.target.value,o()({method:"post",url:"/api/user/banned",data:JSON.stringify(a.bannedData)}).then(function(t){10060===t.data.status?(a.$notify.success({title:"成功",message:t.data.msg}),a.getAllUser()):a.$notify.error({title:"失败",message:t.data.msg})})}}},u=(a(819),a(10)),d=Object(u.a)(i,s,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-header"},[e("h5",{staticClass:"modal-title"},[this._v("重置密码")])])}],!1,null,"bab01fca",null);d.options.__file="index.vue";e.default=d.exports}}]);