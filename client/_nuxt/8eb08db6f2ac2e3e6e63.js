(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{452:function(e,t,i){var n=i(912);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,i(20).default)("7c7b5cd0",n,!1,{sourceMap:!1})},910:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAMAAABF0y+mAAAATlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADEoqZZAAAAGXRSTlMAIKBAgNHwv7pzBmQJBLKjNBcCxZWRZktDHP5HKAAAAIJJREFUKM/tkckOwyAMREmAsASydZ3//9HaRkKlitQcc8g7DB6e5IvVUVZNrLsqzRDm2Hw/DePg+fFwUkMSp1HwmVv0KLyVsGghl5ZLW9QRXnajvD94DhPF5sYqe3SUg+XZDhQd+kueQxo502h2ZaWVAc40OIQq44QfbvF7j25J6i8ftucLl/UeDxsAAAAASUVORK5CYII="},911:function(e,t,i){"use strict";var n=i(452);i.n(n).a},912:function(e,t,i){(e.exports=i(19)(!1)).push([e.i,"\n@media (min-width:768px){\n.mobile-action-bar{margin-right:2rem\n}\n}\n@media (max-width:575.98px){\n.mobile-action-bar{margin-left:1rem;margin-top:1rem!important\n}\n}\n@media (min-width:1200px){\n.bd-sidebar{flex:0 1 320px\n}\n}\n@media (min-width:768px){\n.bd-sidebar{border-right:1px solid rgba(0,0,0,.1);height:calc(100vh - 4rem);position:-webkit-sticky;position:sticky;top:4rem;z-index:1000\n}\n}\n.bd-sidebar{border-bottom:1px solid rgba(0,0,0,.1);order:0\n}\n.countdata-title{font-size:1.4rem;font-weight:500;margin-bottom:2rem;text-align:center\n}\n.countdata-num{color:#2b2b2b;font-size:2.5rem\n}\n.countdata-desc{color:#757575;font-size:.95rem;font-weight:300\n}\n.center-circle{background-color:#fff;border-radius:50%;height:6.6rem;line-height:6.6rem;width:6.6rem\n}\n.center-circle-success{border:.5rem solid red\n}\n.center-circle>.center-circle-text{position:relative;text-align:center\n}\n.satellite_info{color:#707070!important;font-size:.95rem!important\n}\n.satellite_info label{line-height:1.8rem;margin-right:1rem;min-width:5rem;text-align:left\n}\n.standline{background-color:#673ab7\n}\n.redline,.standline{float:left;height:1.1rem;width:3px\n}\n.redline{background-color:#f44336\n}\n.successline{background-color:#4caf50\n}\n.grayline,.successline{float:left;height:1.1rem;width:3px\n}\n.grayline{background-color:#b1bec6\n}\n.page-bug-add-title img{display:inline-block;float:right;height:33px;margin:1rem 1rem 1rem 0;width:33px\n}\n.page-bug-add-title h3{display:inline-block;font-weight:300!important;margin:1rem 0\n}\n.bug-label{text-align:right!important\n}\n@media (max-width:576px){\n.bug-label{text-align:left!important\n}\n}\n@media (max-width:768px){\n#bug-search,#TestCaseSearchInput{display:none\n}\n}\n@media (max-width:414px){\n#TestCaseTodayCount{display:none\n}\n}\n.hiddenSearch{display:none;visibility:hidden\n}\n.showSearch{display:flex;visibility:visible\n}\n.searchIcon img{height:24px;width:24px\n}\n.tableOpreate{display:none\n}\n.showBugOpreate{background-color:inherit;display:inline;margin-left:-7rem;margin-top:-1rem;position:absolute\n}\n.showBugOpreate button{background:inherit;border:none;display:inline-block;outline:none;z-index:9999\n}\n.showCaseOpreate{background-color:inherit;display:inline;margin-left:-5rem;margin-top:-1rem;position:absolute\n}\n.showCaseOpreate button{background:inherit;border:none;display:inline-block;margin-right:.5rem;outline:none;z-index:9999\n}\n.details-title{color:#333;font-size:1.35rem;font-weight:400!important;line-height:2rem\n}\n@media(max-width:576px){\n.bug-details-title{font-size:1.2rem\n}\n}\n.bug-details-minor-title{color:#333;font-size:1.1rem;font-weight:500\n}\n.details-block{background-color:#fafafa;border-radius:5px;color:#2b2b2b;font-size:.94rem;line-height:2rem;margin-top:1rem;padding:1rem\n}\n.details-block a{color:#2973b7!important\n}\n#testcase-modules .el-input__inner{height:2.5rem!important\n}\n.pg-modules{border-right:1px solid #eee\n}\n@media (max-width:576px){\n.pg-modules{display:none\n}\n}\n.t-manage-modules p,a{display:inline\n}\n.t-manage-modules a{float:right;margin-right:2rem\n}\n.t-manage-modules p:hover{color:#1e88e5\n}\n.t-modules-list{-ms-overflow-style:none;height:70vh;margin-bottom:5rem;opacity:1;overflow:-moz-scrollbars-none;overflow-x:hidden;overflow-y:scroll;position:relative;width:100%\n}\n.t-modules-list::-webkit-scrollbar{width:0\n}\n.pg-test-edit>textarea{background-color:#f5f5f5!important\n}\n.add-icon{clear:none;margin-right:5%;margin-top:-2rem;position:absolute;right:0;z-index:1\n}\n.test-case-category{margin:0;padding:0\n}\n.test-case-category li{display:inline;list-style:none;margin-right:1rem\n}\n.p-content-details{background-color:#fff;border-left:5px solid #43a047;margin-top:1.8rem;min-height:5rem;padding:1rem 1rem 1rem 1.5rem\n}\n.p-content-details pre{line-height:1.6rem;margin-left:.2rem\n}\n.p-content-tags{background-color:#f3e5f5;border-radius:10px;color:#6a1b9a;display:inline;font-size:.9rem;font-weight:400;padding:3px\n}\n.radio-inline{padding-left:1rem\n}\n.testcase_add label{font-size:1.1rem;margin:1rem 0 1rem .6rem\n}\n.testcase-category,.testcase-priority{background-color:#fff;border:1px solid #eee;line-height:1.5rem\n}\n.testcase-label{text-align:right!important\n}\n@media (max-width:576px){\n.testcase-label{text-align:left!important\n}\n}\n.paragraph-headings{margin:0 0 1.5rem\n}\n.t-test-main{border-bottom:1px solid #f5f5f5;margin-top:0\n}\n.t_test_main_open{margin-bottom:1rem;margin-top:1rem\n}\n.t-testcase-title{background-color:#fff;color:#000;display:block;font-size:.97rem;height:3.5rem;line-height:3.5rem;margin-top:0;overflow:hidden;padding:0 5rem 0 3rem;position:relative;text-overflow:ellipsis;white-space:nowrap;width:100%\n}\n.is_show_testcase_title{border-bottom:1px solid #e0e0e0\n}\n.t-show-steps{background-color:#fff;min-height:20rem;position:relative\n}\n.t-show-steps h6{color:#8e24aa;font-weight:400;margin:0 0 0 40px;padding-top:1.5rem\n}\n.t-show-steps pre{margin:0 0 0 40px;padding-top:.7rem\n}\n.img-roll-more{-webkit-transform:rotate(90deg);height:32px;margin-right:-3rem;margin-top:.7rem;position:relative;transform:rotate(90deg);width:32px\n}\n.img-roll-more,.roll-operate{display:inline-block;float:right\n}\n.roll-operate{background-color:#fff;padding-left:3rem;position:absolute;right:5rem;visibility:hidden;z-index:100\n}\n.showRollOperate{visibility:visible\n}\n.roll-operate img{display:inline;height:20px;margin-left:1rem;position:relative;width:20px\n}\n.t-testcase-title:hover .roll-operate{visibility:visible\n}\n.t_p1{background-color:rgba(245,107,107,.1);color:#f56c6c\n}\n.t_p1,.t_p2{border:1px solid #eee;border-radius:6px;font-weight:300;margin-left:-1.5rem;margin-right:1rem;padding:3px 10px\n}\n.t_p2{background-color:#e3f2fd;color:#1e88e5\n}\n.t_p3{background-color:#f1f8e9;border:1px solid #eee;border-radius:6px;color:#33691e;font-weight:300;margin-left:-1.5rem;margin-right:1rem;padding:3px 10px\n}\n.annex{position:relative\n}\n.annex:hover>img{-moz-opacity:.3;filter:alpha(Opacity=30);opacity:.3\n}\n.annex>img{border-radius:5px;height:148px;width:148px\n}\n.annex_delete{position:relative;right:90px;visibility:hidden;z-index:100\n}\n.h-annex{margin-top:-150px\n}\n.annex_delete>img{height:28px;width:28px\n}\n.annex:hover .annex_delete{visibility:visible\n}\n.img_scale{-webkit-transform:scale(3);position:relative;transform:scale(3);z-index:100\n}\n.review-area{margin-top:2rem\n}\n.review-box{border-top:1px solid #eee;font-size:.98rem;margin-top:2rem;min-height:5rem;outline:none;overflow-x:hidden;overflow-y:auto;padding:10px 18px 0;word-wrap:break-word\n}\n.review-area>.review-control{border:none;border-top:1px solid #eee;bottom:0;display:block;font-size:.9rem;line-height:1.6rem;min-height:5rem;outline:none;overflow:hidden;overflow-y:hidden;padding:.5rem 1rem 0;resize:none;right:0;width:100%\n}\n.custom-file{border:1px dashed #b2b2b2;display:inline-block;margin-bottom:0;min-height:5rem;position:relative;width:100%\n}\n.custom-file-input{line-height:5rem;margin:0;opacity:0;position:relative;width:100%;z-index:2\n}\n.custom-file-label{background-color:#fff;border:none;color:#757575;height:calc(2.25rem + 2px);line-height:1.5;margin-top:1.35rem;padding:.375rem .75rem;position:absolute;text-align:center;z-index:1\n}\n.custom-file-label:after{display:none\n}\n.file-upload-icon{height:36px;width:36px\n}\n.log-text-time,.log-text-user{font-size:.94rem\n}\n.log-text-user{color:#2973b7\n}\n.log-text-remark{background:#f5f5f5;border-radius:5px;color:#383838;margin-top:.7rem;padding:1rem;text-align:left!important;white-space:pre-line\n}\n.bug-query-selected{color:#9c27b0\n}\n.bug-query-selected-byme{color:#3f51b5\n}",""])},949:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container px-0 white-background"},[n("div",{staticClass:"row",attrs:{id:"bug"}},[n("div",{staticClass:"col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12"},[n("form",{staticClass:"container-fluid"},[n("h3",{staticStyle:{"margin-top":"4rem","text-align":"center","font-weight":"300"}},[e._v("编辑缺陷")]),e._v(" "),n("div",{staticClass:"form-group row mt-5"},[e._m(0),e._v(" "),n("el-select",{staticClass:"col-sm-2",attrs:{placeholder:"请选择产品"},model:{value:e.Bug.product_code,callback:function(t){e.$set(e.Bug,"product_code",t)},expression:"Bug.product_code"}},e._l(e.product_list,function(e){return n("el-option",{key:e.id,attrs:{label:e.product_code,value:e.product_code}})})),e._v(" "),n("el-select",{staticClass:"col-sm-2",attrs:{placeholder:"请选择版本"},model:{value:e.Bug.release,callback:function(t){e.$set(e.Bug,"release",t)},expression:"Bug.release"}},e._l(e.release_list,function(e){return n("el-option",{key:e.id,attrs:{label:e.version,value:e.version}})})),e._v(" "),n("el-cascader",{staticClass:"col-sm-4 px-3",attrs:{options:e.modules_list,filterable:"","change-on-select":"",placeholder:"选择模块"},model:{value:e.Bug.module_id,callback:function(t){e.$set(e.Bug,"module_id",t)},expression:"Bug.module_id"}})],1),e._v(" "),n("div",{staticClass:"form-group row"},[e._m(1),e._v(" "),n("el-select",{staticClass:"col-sm-2",attrs:{placeholder:"选择指派人"},model:{value:e.Bug.assignedTo_id,callback:function(t){e.$set(e.Bug,"assignedTo_id",t)},expression:"Bug.assignedTo_id"}},e._l(e.developer_list,function(e){return n("el-option",{key:e.id,attrs:{label:e.realname,value:e.user_id}})})),e._v(" "),n("el-select",{staticClass:"col-sm-2",attrs:{placeholder:"选择优先级"},model:{value:e.Bug.priority,callback:function(t){e.$set(e.Bug,"priority",t)},expression:"Bug.priority"}},e._l(e.bug_priority,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.key}})})),e._v(" "),n("el-select",{staticClass:"col-sm-2",attrs:{placeholder:"选择严重程度"},model:{value:e.Bug.severity,callback:function(t){e.$set(e.Bug,"severity",t)},expression:"Bug.severity"}},e._l(e.bug_severity,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.key}})})),e._v(" "),n("el-select",{staticClass:"col-sm-2",attrs:{placeholder:"选择缺陷类型"},model:{value:e.Bug.bug_type,callback:function(t){e.$set(e.Bug,"bug_type",t)},expression:"Bug.bug_type"}},e._l(e.bug_type,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.key}})}))],1),e._v(" "),n("div",{attrs:{id:"t-bug-info"}},[n("div",{staticClass:"form-group row"},[e._m(2),e._v(" "),n("el-input",{staticClass:"col-sm-8",attrs:{type:"text",id:"bug_title",placeholder:"标题，最多100个字符 ~.",maxlength:"100",required:""},model:{value:e.Bug.title,callback:function(t){e.$set(e.Bug,"title","string"==typeof t?t.trim():t)},expression:"Bug.title"}})],1),e._v(" "),n("div",{staticClass:"form-group row"},[e._m(3),e._v(" "),n("el-input",{staticClass:"col-sm-8",attrs:{type:"textarea",autosize:{minRows:5},maxlength:"1000",placeholder:"请输入发现步骤"},model:{value:e.Bug.steps,callback:function(t){e.$set(e.Bug,"steps","string"==typeof t?t.trim():t)},expression:"Bug.steps"}})],1),e._v(" "),n("div",{staticClass:"form-group row"},[e._m(4),e._v(" "),n("el-input",{staticClass:"col-sm-8",attrs:{type:"textarea",autosize:{minRows:3},maxlength:"1000",placeholder:"实际结果..."},model:{value:e.Bug.reality_result,callback:function(t){e.$set(e.Bug,"reality_result","string"==typeof t?t.trim():t)},expression:"Bug.reality_result"}})],1),e._v(" "),n("div",{staticClass:"form-group row"},[n("label",{staticClass:"col-sm-2 bug-label",attrs:{for:"bug-expected-result"}},[e._v("预期结果")]),e._v(" "),n("el-input",{staticClass:"col-sm-8",attrs:{type:"textarea",autosize:{minRows:3},maxlength:"1000",placeholder:"预期结果..."},model:{value:e.Bug.expected_result,callback:function(t){e.$set(e.Bug,"expected_result","string"==typeof t?t.trim():t)},expression:"Bug.expected_result"}})],1),e._v(" "),n("div",{staticClass:"form-group row"},[n("label",{staticClass:"col-sm-2 bug-label",attrs:{for:"bug-remark"}},[e._v("备注")]),e._v(" "),n("el-input",{staticClass:"col-sm-8",attrs:{type:"textarea",autosize:{minRows:3},maxlength:"1000",placeholder:"请输入备注..."},model:{value:e.Bug.remark,callback:function(t){e.$set(e.Bug,"remark","string"==typeof t?t.trim():t)},expression:"Bug.remark"}})],1),e._v(" "),n("div",{staticClass:"form-group row"},[n("label",{staticClass:"col-sm-2 bug-label"},[e._v("附件")]),e._v(" "),n("form",{staticClass:"col-sm-8"},[e._l(e.Annex,function(t){return n("div",{key:t.id,staticClass:"annex",staticStyle:{display:"inline"}},[n("img",{class:{"h-annex":e.Bug.annex.length>0},attrs:{src:t.url}}),e._v(" "),n("span",{staticClass:"annex_delete",on:{click:function(i){e.annex_delete(t.url)}}},[n("img",{class:{"h-annex":e.Bug.annex.length>0},attrs:{src:i(910)}})])])}),e._v(" "),n("el-upload",{staticStyle:{display:"inline"},attrs:{name:"images",action:"/api/support/upload","list-type":"picture-card",limit:3,"on-success":e.ImageSuccess,"on-remove":e.handleRemove,beforeUpload:e.beforeAvatarUpload,"file-list":e.fileList}},[n("i",{staticClass:"el-icon-plus"})])],2)])]),e._v(" "),n("div",{staticClass:"d-flex justify-content-center my-5"},[n("button",{staticClass:"btn btn-transparent",attrs:{type:"button"},on:{click:function(t){e.$router.go(-1)}}},[e._v("返回")]),e._v(" "),n("button",{staticClass:"btn btn-submit mx-5 px-3",attrs:{type:"button",disabled:e.isButtonDisabled},on:{click:function(t){e.editBug()}}},[e._v("提交修改")])])])])])])};n._withStripped=!0;i(73),i(40);var r=i(4),a=i.n(r),o={head:function(){return{title:"HDesk - 缺陷编辑"}},validate:function(e){return!!e.query.bug_id},layout:"head",data:function(){return{fileList:[],bug_type:[],bug_priority:[],bug_severity:[],developer_list:[],product_list:[],release_list:[],modules_list:[],isButtonDisabled:!1,BugDetails:{},product_code:"",Annex:[],AnnexDelData:{url:null},Bug:{bug_id:null,priority:null,severity:null,bug_type:null,product_code:null,release:null,assignedTo_id:null,module_id:[],annex:[]}}},computed:{uploadDisabled:function(){return this.fileList.length>3},selected_product_code:function(){return this.Bug.product_code}},watch:{selected_product_code:function(e,t){this.getModule()}},created:function(){this.currentBugId=this.$route.query.bug_id,this.getBugDetails()},mounted:function(){this.getProductRelease(),this.getBugProperty()},methods:{getModule:function(){var e=this;a.a.get("/api/pm/get_module?product_code="+this.Bug.product_code).then(function(t){2e4===t.data.status?e.modules_list=t.data.data:e.Msg=t.data.msg})},getBugDetails:function(){var e=this;this.currentBugId&&a.a.get("/api/qa/bug/details?bug_id="+this.currentBugId).then(function(t){if(2e4===t.data.status){var i=t.data.data;e.Bug.title=i.title,e.Annex=t.data.annex,e.Bug.steps=i.steps,e.Bug.reality_result=i.reality_result,e.Bug.expected_result=i.expected_result,e.Bug.remark=i.remark,e.Bug.assignedTo_id=i.assignedTo_id,e.Bug.bug_type=i.bug_type,e.Bug.priority=i.priority,e.Bug.severity=i.severity,e.Bug.release=i.release,e.Bug.product_code=i.product_code,e.Bug.bug_id=i.bug_id,i.m1_id&&(e.Bug.module_id[0]=i.m1_id),i.m2_id&&(e.Bug.module_id[1]=i.m2_id)}})},getProductRelease:function(){var e=this;a.a.get("/api/pm/product_release").then(function(t){2e4===t.data.status&&(e.product_list=t.data.data,e.release_list=t.data.data[0].data,e.Bug.product_code=t.data.data[0].product_code,e.getDeveloper())})},annex_delete:function(e){var t=this;t.AnnexDelData.url=e,a()({method:"post",url:"/api/qa/bug/annex/delete",data:t.AnnexDelData}).then(function(i){if(2e4===i.data.status){var n=new Array;for(var r in n=t.Annex)if(e==n[r].url){var a=n.indexOf(n[r]);a>-1&&n.splice(a,1)}t.$notify.success({title:"成功",message:i.data.msg})}else t.$notify.error({title:"失败",message:i.data.msg})})},handleRemove:function(e){for(var t=e.response.name,i=this.Bug.annex,n=0;n<i.length;n++)i[n]==t&&i.splice(n,1)},ImageSuccess:function(e,t){this.Bug.annex.push(e.name)},beforeAvatarUpload:function(e){var t=e.size/1024/1024<3,i="jpg"===e.name.split(".")[1],n="png"===e.name.split(".")[1],r="jpeg"===e.name.split(".")[1],a="gif"===e.name.split(".")[1];e.size;return i||n||r||a||this.$notify.error({title:"上传失败",message:"上传图片格式只能为jpg/png/jpeg/gif"}),t||this.$notify.error({title:"上传失败",message:"上传文件大小不能超过2.5M"}),i||n||r||a&&t},getBugProperty:function(){var e=this;a.a.get("/api/qa/bug/bug_property").then(function(t){2e4===t.data.status&&(e.bug_type=t.data.bug_type,e.bug_priority=t.data.bug_priority,e.bug_severity=t.data.bug_severity)})},getDeveloper:function(){var e=this;a.a.get("/api/pm/member/list?product_code="+this.Bug.product_code).then(function(t){2e4===t.data.status&&(e.developer_list=t.data.data)})},editBug:function(e){var t=this;0!==this.Bug.release.length?this.Bug.title.length<6|this.Bug.title.length>100?this.$notify.error({title:"提示",message:"标题的有效长度为6到100之间"}):0!==this.Bug.steps.length?this.Bug.steps.length<10|this.Bug.steps.length>1e3?this.$notify.error({title:"提示",message:"操作步骤有效长度为10到1000"}):0!==this.Bug.reality_result.length?this.Bug.reality_result.length<2|this.Bug.reality_result.length>500?this.$notify.error({title:"提示",message:"实际结果长度为2到500"}):this.Bug.expected_result.length>500?this.$notify.error({title:"提示",message:"预期结果, 长度需小于500"}):this.Bug.remark.length>1e3?this.$notify.error({title:"提示",message:"备注输入太长了,长度需要小于1000"}):a()({method:"post",url:"/api/qa/bug/edit",data:JSON.stringify(t.Bug),transformRequest:[function(e){return t.isButtonDisabled=!0,e}]}).then(function(e){2e4===e.data.status?(t.$notify.success({title:"成功",message:e.data.msg}),t.$router.go(-1)):(t.isButtonDisabled=!1,t.$notify.error({title:"失败",message:e.data.msg}))}):this.$notify.error({title:"提示",message:"实际结果不能为空哦"}):this.$notify.error({title:"提示",message:"操作步骤不能为空哦"}):this.$notify.error({title:"提示",message:"请选择版本号"})}}},s=(i(911),i(10)),l=Object(s.a)(o,n,[function(){var e=this.$createElement,t=this._self._c||e;return t("label",{staticClass:"col-sm-2 bug-label",attrs:{for:"BugInfo"}},[this._v("产品与模块"),t("span",{staticClass:"text-red"},[this._v("*")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("label",{staticClass:"col-sm-2 testcase-label",attrs:{for:"BugInfo"}},[this._v("缺陷属性信息"),t("span",{staticClass:"text-red"},[this._v("*")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("label",{staticClass:"col-sm-2 bug-label",attrs:{for:"bug-title"}},[this._v("缺陷标题"),t("span",{staticClass:"text-red"},[this._v("*")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("label",{staticClass:"col-sm-2 bug-label",attrs:{for:"bug-steps"}},[this._v("发现步骤"),t("span",{staticClass:"text-red"},[this._v("*")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("label",{staticClass:"col-sm-2 bug-label",attrs:{for:"bug-reality-result"}},[this._v("实际结果"),t("span",{staticClass:"text-red"},[this._v("*")])])}],!1,null,null,null);l.options.__file="edit.vue";t.default=l.exports}}]);